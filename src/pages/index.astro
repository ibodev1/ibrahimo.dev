---
import { getCollection } from 'astro:content';
import { Button } from '@/components/ui/button';
import { Separator } from '@/components/ui/separator';
import Layout from '@/layouts/main.astro';
import Hero from '@/components/Hero.astro';
import ProjectCard from '@/components/ProjectCard.astro';
import BlogCard from '@/components/BlogCard.astro';

const allProjects = await getCollection('projects');
const recentProjects = allProjects.slice(0, 2);

const allBlogs = await getCollection('blog');
const recentBlogs = allBlogs.sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf()).slice(0, 2);
---

<Layout title="Home">
  <!-- Main Content Container -->
  <div class="container mx-auto max-w-4xl px-4">
    <Hero />

    <Separator className="my-12" />

    <!-- Projects Section -->
    <section id="projects" class="py-16">
      <div class="mb-12 text-center">
        <h2 class="mb-4 text-3xl font-bold">Recent Projects</h2>
      </div>
      <div class="grid gap-6 md:grid-cols-2">
        {
          recentProjects.map((project) => (
            <ProjectCard
              title={project.data.title}
              description={project.data.description}
              tags={project.data.tags}
              demoUrl={project.data.demoUrl}
              githubUrl={project.data.githubUrl}
            />
          ))
        }
      </div>
      <div class="mt-8 text-center">
        <Button variant="outline" className="transition-transform hover:scale-105">
          <a href="/projects" class="flex items-center"> All Projects → </a>
        </Button>
      </div>
    </section>

    <Separator className="my-12" />

    <!-- Blog Section -->
    <section id="blog" class="py-16">
      <div class="mb-12 text-center">
        <h2 class="mb-4 text-3xl font-bold">Recent Posts</h2>
      </div>
      <div class="grid gap-6">
        {
          recentBlogs.map((blog) => (
            <BlogCard
              title={blog.data.title}
              description={blog.data.description}
              publishDate={blog.data.publishDate}
              tags={blog.data.tags}
              slug={blog.slug}
            />
          ))
        }
      </div>
      <div class="mt-8 text-center">
        <Button variant="outline" className="transition-transform hover:scale-105">
          <a href="/blog" class="flex items-center"> All Posts → </a>
        </Button>
      </div>
    </section>
  </div>
</Layout>
